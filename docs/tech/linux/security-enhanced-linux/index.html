<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="false"><head>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>Security Enhanced Linux &middot; </title>
    <meta name="title" content="Security Enhanced Linux &middot; ">
  

  
  
    <meta name="description" content="The confusing world of SELinux">
  
  
  
  
  <link rel="canonical" href="https://davidwrites.xyz/tech/linux/security-enhanced-linux/">
  

  
  
  

  
  <meta property="og:url" content="https://davidwrites.xyz/tech/linux/security-enhanced-linux/">
  <meta property="og:title" content="Security Enhanced Linux">
  <meta property="og:description" content="The confusing world of SELinux">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tech">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Security Enhanced Linux">
  <meta name="twitter:description" content="The confusing world of SELinux">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
  
  
  
  

  

  
  
  
  
  
  
  
    
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.55454138fbaa36c0232d68135cd9933115627c813e846361f82ebc8dc6d6a4557af89124e41aa465c677592556acb50643a1e8e9a77adfdd6daf990fd094a009.css"
    integrity="sha512-VUVBOPuqNsAjLWgTXNmTMRVifIE&#43;hGNh&#43;C68jcbWpFV6&#43;JEk5BqkZcZ3WSVWrLUGQ6Ho6ad6391tr5kP0JSgCQ==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.b3e04755916f0df261b5d61a68854cdfe374f4f0788bd95c7dd4a8493829036d999f7931d810683ea8adb094c97c2f5616e95748b0b9e3da4a19070d27b2c99b.js"
    integrity="sha512-s&#43;BHVZFvDfJhtdYaaIVM3&#43;N09PB4i9lcfdSoSTgpA22Zn3kx2BBoPqitsJTJfC9WFulXSLC549pKGQcNJ7LJmw=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
  
    
  
  
    
  
  
    
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.9cc802d09f28c6af56ceee7bc6e320a39251fdae98243f2a9942f221ac57a9f49c51609699a91794a7b2580ee1deaa8e4d794a68ffa94aa317c66e893ce51e02.js"
      integrity="sha512-nMgC0J8oxq9Wzu57xuMgo5JR/a6YJD8qmULyIaxXqfScUWCWmakXlKeyWA7h3qqOTXlKaP&#43;pSqMXxm6JPOUeAg=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>


























  

  

  

  

  





  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Teches",
    "name": "Security Enhanced Linux",
    "headline": "Security Enhanced Linux",
    "description": "The confusing world of SELinux",
    "abstract": "\u003ch2 class=\u0022relative group\u0022\u003eSELinux Terminology\n    \u003cdiv id=\u0022selinux-terminology\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\u0022\u003e\n        \u003ca class=\u0022text-primary-300 dark:text-neutral-700 !no-underline\u0022 href=\u0022#selinux-terminology\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e\n    \n\u003c\/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eImplementation of the Mandatory Access Control (MAC) architecture\u003c\/p\u003e\n\u003cul\u003e\n\u003cli\u003edeveloped by the U.S. National Security Agency (NSA)\u003c\/li\u003e\n\u003cli\u003eflexible, enriched, and granular security controls in Linux.\u003c\/li\u003e\n\u003cli\u003eintegrated into the Linux kernel as a set of patches using the Linux Security Modules (LSM) framework\n\u003cul\u003e\n\u003cli\u003eallows the kernel to support various security implementations\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003c\/li\u003e\n\u003cli\u003eprovides an added layer of protection above and beyond the standard Linux Discretionary Access Control (DAC) security architecture.\u003c\/li\u003e\n\u003cli\u003eDAC includes:\n\u003cul\u003e\n\u003cli\u003etraditional file and directory permissions\u003c\/li\u003e\n\u003cli\u003eextended attribute settings\u003c\/li\u003e\n\u003cli\u003esetuid\/setgid bits\u003c\/li\u003e\n\u003cli\u003esu\/sudo privileges\u003c\/li\u003e\n\u003cli\u003eetc.\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003c\/li\u003e\n\u003cli\u003eLimits the ability of a \u003cstrong\u003esubject\u003c\/strong\u003e (Linux user or process) to access an \u003cstrong\u003eobject\u003c\/strong\u003e (file, directory, file system, device, network interface\/connection, port, pipe, socket, etc.)\n\u003cul\u003e\n\u003cli\u003eTo reduce or eliminate the potential damage the subject may be able to inflict on the system if compromised.\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003c\/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eMAC controls\u003c\/strong\u003e\u003c\/p\u003e",
    "inLanguage": "en",
    "url" : "https://davidwrites.xyz/tech/linux/security-enhanced-linux/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    
    
    
    
    
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "5059"
  }]
  </script>



  
  
    


  

  <script
    data-id="umami-script"
    async
    src="https://analytics.umami.is/script.js"
    data-website-id="60fe8af1-376f-4be3-8f62-d4f24d00a756"></script>




  <script type="text/javascript">
    document.querySelector('script[data-id="umami-script"]').addEventListener("load", function () {
      const type = document.head.querySelector('meta[property = "og:type"]').getAttribute("content");
      let title = document.head.querySelector('meta[property = "og:title"]').getAttribute("content");
      let url = document.head.querySelector('meta[property = "og:url"]').getAttribute("content");
      umami.track(type + ":" + title, { url: url });
    });
  </script>





  

  
  

  
  

  
  
    
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
      <script>

    const firebaseConfig = {
      apiKey: "AIzaSyApsKLCbGb5fkkrzxABOtl3-OUuBcRPVsc",
      authDomain: "davidwrites-89dd7.firebaseapp.com",
      projectId: "davidwrites-89dd7",
      storageBucket: "davidwrites-89dd7.firebasestorage.app",
      messagingSenderId: "433139099634",
      appId: "1:433139099634:web:c14275555bd7171e6c6d6b",
      measurementId: "G-XX5507B82W"
    };

        var app = firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();
        var auth = firebase.auth();

      </script>
    
  

  
  
</head>







  
    
  







  
    
  






  
  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      













<div
  class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0">
  
  
    
    
      <div>
        <a href="/" class="flex">
          <span class="sr-only"></span>
          
            <img
              src="/img/logo.png"
              width="200"
              height="37"
              class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom"
              alt="">
          
        </a>
      </div>
    

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/notes/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Notes"
  title="Book Notes &amp; Reviews">
  
  
    <p class="text-base font-medium">
      Notes
    </p>
  
</a>



      
        
  <a
  href="/articles/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Articles"
  title="Articles">
  
  
    <p class="text-base font-medium">
      Articles
    </p>
  
</a>



      
        
  <a
  href="/now/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Now"
  title="Now">
  
  
    <p class="text-base font-medium">
      Now
    </p>
  
</a>



      
        
  <a
  href="https://github.com/davidwritesxyz"
  target="_blank"
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="github"
  title="">
  
    <span >
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>
    </span>
  
  
</a>



      
        
  <a
  href=""
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  
  title="">
  
  
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
          </div>
          <div class="items-center justify-center hidden dark:flex">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/notes/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Notes"
    title="Book Notes &amp; Reviews">
    
    
      <p class="text-bg font-bg">
        Notes
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/articles/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Articles"
    title="Articles">
    
    
      <p class="text-bg font-bg">
        Articles
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/now/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Now"
    title="Now">
    
    
      <p class="text-bg font-bg">
        Now
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="https://github.com/davidwritesxyz"
    
      target="_blank"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="github"
    title="">
    
      <div >
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>
      </div>
    
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href=""
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    
    title="">
    
    
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>




  <script>
    (function () {
      var $mainmenu = $(".main-menu");
      var path = window.location.pathname;
      $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
        $(e).children("p").addClass("active");
      });
    })();
  </script>


    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Security Enhanced Linux
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  
    
  

  

  

  

  
    
  

  
    
  

  
    
  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="0001-01-01T00:00:00&#43;00:00">1 January 0001</time><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span
    id="views_tech/linux/Security Enhanced Linux.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="views"
    >loading</span
  >
  <span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span>
</span>
<span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span
    id="likes_tech/linux/Security Enhanced Linux.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes"
    >loading</span
  >
  <span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span>
</span>
<span class="px-2 text-primary-500">&middot;</span><span>
  <button
    id="button_likes"
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    <span id="button_likes_heart" class="inline-block align-text-bottom hidden"
      ><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span>
    </span>
    <span id="button_likes_emtpty_heart" class="inline-block align-text-bottom"
      ><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"/></svg></span></span
    >
    <span id="button_likes_text">&nbsp;Like</span>
  </button>
</span>
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
  <div class="place-self-center">
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

  

  

  
    <div class="mb-5"></div>
  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#selinux-terminology">SELinux Terminology</a>
      <ul>
        <li><a href="#key-terms">Key Terms</a></li>
      </ul>
    </li>
    <li><a href="#selinux-contexts">SELinux Contexts</a>
      <ul>
        <li><a href="#selinux-contexts-for-users">SELinux Contexts for Users</a></li>
        <li><a href="#selinux-contexts-for-processes">SELinux Contexts for Processes</a></li>
        <li><a href="#selinux-contexts-for-files">SELinux Contexts for Files</a></li>
        <li><a href="#copying-moving-and-archiving-files-with-selinux-contexts">Copying, Moving, and Archiving Files with SELinux Contexts</a></li>
        <li><a href="#selinux-contexts-for-ports">SELinux Contexts for Ports</a></li>
      </ul>
    </li>
    <li><a href="#domain-transitioning">Domain Transitioning</a></li>
    <li><a href="#selinux-booleans">SELinux Booleans</a></li>
    <li><a href="#selinux-administration">SELinux Administration</a>
      <ul>
        <li><a href="#management-commands">Management Commands</a></li>
        <li><a href="#viewing-and-controlling-selinux-operational-state">Viewing and Controlling SELinux Operational State</a></li>
        <li><a href="#querying-status">Querying Status</a></li>
        <li><a href="#lab-modify-selinux-file-context">Lab: Modify SELinux File Context</a></li>
        <li><a href="#lab-add-and-apply-file-context">Lab: Add and Apply File Context</a></li>
        <li><a href="#lab-add-and-delete-network-ports">Lab: Add and Delete Network Ports</a></li>
        <li><a href="#lab-copy-files-with-and-without-context">Lab: Copy Files with and without Context</a></li>
        <li><a href="#exercise-20-5-view-and-toggle-selinux-boolean-values">Exercise 20-5: View and Toggle SELinux Boolean Values</a></li>
        <li><a href="#monitoring-and-analyzing-selinux-violations">Monitoring and Analyzing SELinux Violations</a></li>
        <li><a href="#lab-get-an-avc-deny-message">Lab Get an AVC deny message</a></li>
      </ul>
    </li>
    <li><a href="#selinux-diy-labs">SELinux DIY Labs</a>
      <ul>
        <li><a href="#lab-disable-and-enable-the-selinux-operating-mode">Lab: Disable and Enable the SELinux Operating Mode</a></li>
        <li><a href="#lab-modify-context-on-files">Lab: Modify Context on Files</a></li>
        <li><a href="#lab-add-network-port-to-policy-database">Lab: Add Network Port to Policy Database</a></li>
        <li><a href="#lab-copy-files-with-and-without-context-1">Lab: Copy Files with and without Context</a></li>
        <li><a href="#lab-flip-selinux-booleans">Lab: Flip SELinux Booleans</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#selinux-terminology">SELinux Terminology</a>
      <ul>
        <li><a href="#key-terms">Key Terms</a></li>
      </ul>
    </li>
    <li><a href="#selinux-contexts">SELinux Contexts</a>
      <ul>
        <li><a href="#selinux-contexts-for-users">SELinux Contexts for Users</a></li>
        <li><a href="#selinux-contexts-for-processes">SELinux Contexts for Processes</a></li>
        <li><a href="#selinux-contexts-for-files">SELinux Contexts for Files</a></li>
        <li><a href="#copying-moving-and-archiving-files-with-selinux-contexts">Copying, Moving, and Archiving Files with SELinux Contexts</a></li>
        <li><a href="#selinux-contexts-for-ports">SELinux Contexts for Ports</a></li>
      </ul>
    </li>
    <li><a href="#domain-transitioning">Domain Transitioning</a></li>
    <li><a href="#selinux-booleans">SELinux Booleans</a></li>
    <li><a href="#selinux-administration">SELinux Administration</a>
      <ul>
        <li><a href="#management-commands">Management Commands</a></li>
        <li><a href="#viewing-and-controlling-selinux-operational-state">Viewing and Controlling SELinux Operational State</a></li>
        <li><a href="#querying-status">Querying Status</a></li>
        <li><a href="#lab-modify-selinux-file-context">Lab: Modify SELinux File Context</a></li>
        <li><a href="#lab-add-and-apply-file-context">Lab: Add and Apply File Context</a></li>
        <li><a href="#lab-add-and-delete-network-ports">Lab: Add and Delete Network Ports</a></li>
        <li><a href="#lab-copy-files-with-and-without-context">Lab: Copy Files with and without Context</a></li>
        <li><a href="#exercise-20-5-view-and-toggle-selinux-boolean-values">Exercise 20-5: View and Toggle SELinux Boolean Values</a></li>
        <li><a href="#monitoring-and-analyzing-selinux-violations">Monitoring and Analyzing SELinux Violations</a></li>
        <li><a href="#lab-get-an-avc-deny-message">Lab Get an AVC deny message</a></li>
      </ul>
    </li>
    <li><a href="#selinux-diy-labs">SELinux DIY Labs</a>
      <ul>
        <li><a href="#lab-disable-and-enable-the-selinux-operating-mode">Lab: Disable and Enable the SELinux Operating Mode</a></li>
        <li><a href="#lab-modify-context-on-files">Lab: Modify Context on Files</a></li>
        <li><a href="#lab-add-network-port-to-policy-database">Lab: Add Network Port to Policy Database</a></li>
        <li><a href="#lab-copy-files-with-and-without-context-1">Lab: Copy Files with and without Context</a></li>
        <li><a href="#lab-flip-selinux-booleans">Lab: Flip SELinux Booleans</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'
    let isJumpingToAnchor = false

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      if (isJumpingToAnchor) {
        for (let i = 0; i < anchors.length; i++) {
          const anchor = anchors[i]
          if (!tocIds.has(anchor.id)) continue
          const top = anchor.getBoundingClientRect().top + window.scrollY
          if (Math.abs(window.scrollY - top) < 100) {
            return anchor.id
          }
        }
      }

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = true
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      links.forEach(link => {
        link.addEventListener('click', () => {
          isJumpingToAnchor = true
        })
      })

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          
<h2 class="relative group">SELinux Terminology
    <div id="selinux-terminology" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#selinux-terminology" aria-label="Anchor">#</a>
    </span>
    
</h2>
<ul>
<li>
<p>Implementation of the Mandatory Access Control (MAC) architecture</p>
<ul>
<li>developed by the U.S. National Security Agency (NSA)</li>
<li>flexible, enriched, and granular security controls in Linux.</li>
<li>integrated into the Linux kernel as a set of patches using the Linux Security Modules (LSM) framework
<ul>
<li>allows the kernel to support various security implementations</li>
</ul>
</li>
<li>provides an added layer of protection above and beyond the standard Linux Discretionary Access Control (DAC) security architecture.</li>
<li>DAC includes:
<ul>
<li>traditional file and directory permissions</li>
<li>extended attribute settings</li>
<li>setuid/setgid bits</li>
<li>su/sudo privileges</li>
<li>etc.</li>
</ul>
</li>
<li>Limits the ability of a <strong>subject</strong> (Linux user or process) to access an <strong>object</strong> (file, directory, file system, device, network interface/connection, port, pipe, socket, etc.)
<ul>
<li>To reduce or eliminate the potential damage the subject may be able to inflict on the system if compromised.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>MAC controls</strong></p>
<ul>
<li>Fine-grained</li>
<li>Protect other services in the event one service is negotiated.</li>
<li>Example:
<ul>
<li>If the HTTP service process is compromised, the attacker can only damage the files the hacked process will have access to, and not the other processes running on the system, or the objects the other processes will have access to.</li>
</ul>
</li>
<li>To ensure this coarse-grained control, MAC uses a set of defined authorization rules called <strong>policy</strong> to examine security attributes associated with subjects and objects when a subject tries to access an object, and decides whether to permit the access attempt.</li>
<li>These attributes are stored in <strong>contexts</strong> (a.k.a. <strong>labels</strong>), and are applied to both subjects and objects.</li>
</ul>
</li>
<li>
<p>SELinux decisions are stored in a special cache area called <strong>Access</strong> <strong>Vector Cache</strong> (<strong>AVC</strong>).</p>
</li>
<li>
<p>This cache area is checked for each access attempt by a process to determine whether the access attempt was previously allowed.</p>
</li>
<li>
<p>With this mechanism in place, SELinux does not have to check the policy ruleset repeatedly, thus improving performance.</p>
</li>
<li>
<p>SELinux is enabled by default</p>
<ul>
<li>Confines processes to the bare minimum privileges that they need to function.</li>
</ul>
</li>
</ul>

<h3 class="relative group">Key Terms
    <div id="key-terms" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#key-terms" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><strong>Subject</strong></p>
<ul>
<li>Any user or process that accesses an object.</li>
<li>Examples:
<ul>
<li><em>system_u</em> for the SELinux system user</li>
<li><em>unconfined_u</em> for subjects that are not bound by the SELinux policy</li>
</ul>
</li>
<li>Stored in field 1 of the context.</li>
</ul>
<p><strong>Object</strong></p>
<ul>
<li>A resource, such as a file, directory, hardware device, network interface/connection, port, pipe, or socket, that a subject accesses.</li>
<li>Examples:
<ul>
<li><em>object_r</em> for general objects</li>
<li><em>system_r</em> for system-owned objects</li>
<li><em>unconfined_r</em> for objects that are not bound by the SELinux policy.</li>
</ul>
</li>
</ul>
<p><strong>Access</strong></p>
<ul>
<li>An action performed by the subject on an object.</li>
<li>Examples:
<ul>
<li>creating, reading, or updating a file</li>
<li>creating or navigating a directory</li>
<li>accessing a network port or socket</li>
</ul>
</li>
</ul>
<p><strong>Policy</strong></p>
<ul>
<li>A defined ruleset that is enforced system-wide</li>
<li>Used to analyze security attributes assigned to subjects and objects.</li>
<li>Referenced to decide whether to permit a subject&rsquo;s access attempt to an object, or a subject&rsquo;s attempt to interact with another subject.</li>
<li>The default behavior of SELinux in the absence of a rule is to deny the access.</li>
<li>Standard preconfigured policies:
<ul>
<li><strong>targeted</strong> (default)
<ul>
<li>Any process that is targeted runs in a confined domain</li>
<li>Any process that is not targeted runs in an unconfined domain.</li>
<li>Example:
<ul>
<li>SELinux runs logged-in users in the unconfined domain, and the httpd process in a confined domain by default.</li>
<li>Any subject running unconfined is more vulnerable than the one running confined.</li>
</ul>
</li>
</ul>
</li>
<li><strong>mls</strong>
<ul>
<li>Places tight security controls at deeper levels.</li>
</ul>
</li>
<li><strong>minimum</strong>
<ul>
<li>light version of the targeted policy</li>
<li>designed to protect only selected processes.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Context</strong> (label)</p>
<ul>
<li>A tag to store security attributes for subjects and objects.</li>
<li>Every subject and object has a context assigned</li>
<li>Consists of a SELinux user, role, type (or domain), and sensitivity level.</li>
<li>Used by SELinux  to make access control decisions.</li>
</ul>
<p><strong>Labeling</strong></p>
<ul>
<li>Mapping of files with their stored contexts.</li>
</ul>
<p><strong>SELinux User</strong></p>
<ul>
<li>Several predefined SELinux user identities that are authorized for a particular set of roles.</li>
<li>Linux user to SELinux user identity mapping to place SELinux user restrictions on Linux users.</li>
<li>Controls what roles and levels a process (with a particular SELinux user identity) can enter.</li>
<li>Example:
<ul>
<li>A Linux user cannot run the <code>su</code> and <code>sudo</code> commands or the programs located in their home directories if they are mapped to the SELinux user <em>user_u</em>.</li>
</ul>
</li>
</ul>
<p><strong>Role</strong></p>
<ul>
<li>An attribute of the <strong>Role-Based Access Control (RBAC)</strong> security model that is part of SELinux.</li>
<li>Classifies who (subject) is allowed to access what (domains or types).</li>
<li>SELinux users are authorized for roles, and roles are authorized for domains and types.</li>
<li>Each subject has an associated role to ensure that the system and user processes are separated.</li>
<li>A subject can transition into a new role to gain access to other domains and types.</li>
<li>Examples:
<ul>
<li><em>user_r</em> for ordinary users</li>
<li><em>sysadm_r</em> for administrators</li>
<li><em>system_r</em> for processes that initiate under the <em>system_r</em> role</li>
</ul>
</li>
<li>Stored in field 2 of the context.</li>
</ul>
<p><strong>Type Enforcement</strong> (TE)</p>
<ul>
<li>Identifies and limits a subject&rsquo;s ability to access domains for processes, and types for files.</li>
<li>References the contexts of the subjects and objects for this enforcement.</li>
</ul>
<p><strong>Type</strong></p>
<ul>
<li>Attribute of type enforcement.</li>
<li>Group of objects based on uniformity in their security requirements.</li>
<li>Objects such as files and directories with common security requirements, are grouped within a specific type.</li>
<li>Examples:
<ul>
<li><em>user_home_dir_t</em> for objects located in user home directories</li>
<li><em>usr_t</em> for most objects stored in the /usr directory.</li>
</ul>
</li>
<li>Stored in field 3 of a file context.</li>
</ul>
<p><strong>Domain</strong></p>
<ul>
<li>Determines the type of access that a process has.</li>
<li>Processes with common security requirements are grouped within a specific domain type, and they run confined within that domain.</li>
<li>Examples:
<ul>
<li><em>init_t</em> for the systemd process</li>
<li><em>firewalld_t</em> for the firewalld process</li>
<li><em>unconfined_t</em> for all processes that are not bound by SELinux policy.</li>
</ul>
</li>
<li>Stored in field 3 of a process context.</li>
</ul>
<p><strong>Rules</strong></p>
<ul>
<li>Outline how types can access each other, domains can access types, and domains can access each other.</li>
</ul>
<p><strong>Level</strong></p>
<ul>
<li>An attribute of <strong>Multi-Level Security (MLS)</strong> and <strong>Multi-Category</strong> <strong>Security (MCS)</strong>.</li>
<li>Pair of <em>sensitivity:category</em> values that defines the level of security in the context.</li>
<li><em>category</em> may be defined as a single value or a range of values, such as c0.c4 to represent c0 through c4.</li>
<li>In RHEL 9, the targeted policy is used as the default, which enforces <strong>MCS</strong> (MCS supports only one sensitivity level (s0) with 0 to 1023 different categories).</li>
</ul>

<h2 class="relative group">SELinux Contexts
    <div id="selinux-contexts" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#selinux-contexts" aria-label="Anchor">#</a>
    </span>
    
</h2>

<h3 class="relative group">SELinux Contexts for Users
    <div id="selinux-contexts-for-users" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#selinux-contexts-for-users" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>SELinux contexts define security attributes placed on subjects and objects.</li>
<li>Each context contains a type and a security level with subject and object information.</li>
</ul>
<p>Use the <code>id</code> command with the <code>-Z</code> option to view the context set on Linux users:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># id -Z</span>
</span></span><span class="line"><span class="cl">unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
</span></span></code></pre></div><p>Output:</p>
<ul>
<li>
<p>Mapped to the SELinux unconfined_u user</p>
</li>
<li>
<p>No SELinux restrictions placed on this user.</p>
</li>
<li>
<p>All Linux users, including root, run unconfined by default, (full system access)</p>
</li>
<li>
<p>Seven confined user identities with restricted access to objects.</p>
<ul>
<li>Mapped to Linux users via SELinux policy.</li>
<li>Helps safeguard the system from potential damage that Linux users might inflict on the system.</li>
</ul>
</li>
</ul>
<p>Use the <code>seinfo</code> query command to list the SELinux users; however, the <code>setools-console</code> software package must be installed before doing so.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># seinfo -u</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Users: <span class="m">8</span>
</span></span><span class="line"><span class="cl">   guest_u
</span></span><span class="line"><span class="cl">   root
</span></span><span class="line"><span class="cl">   staff_u
</span></span><span class="line"><span class="cl">   sysadm_u
</span></span><span class="line"><span class="cl">   system_u
</span></span><span class="line"><span class="cl">   unconfined_u
</span></span><span class="line"><span class="cl">   user_u
</span></span><span class="line"><span class="cl">   xguest_u
</span></span></code></pre></div><p>Use the <code>semanage</code> command to view the mapping between Linux and SELinux users:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage login -l</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Login Name           SELinux User         MLS/MCS Range        Service
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">__default__          unconfined_u         s0-s0:c0.c1023       *
</span></span><span class="line"><span class="cl">root                 unconfined_u         s0-s0:c0.c1023       *
</span></span></code></pre></div><p><strong>MLS/MCS Range</strong></p>
<ul>
<li>Associated security level and the context for the Linux user (the * represents all services).</li>
<li>By default, all non-root Linux users are represented as <code>__default__</code>, which is mapped to the unconfined_u user in the policy.</li>
</ul>

<h3 class="relative group">SELinux Contexts for Processes
    <div id="selinux-contexts-for-processes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#selinux-contexts-for-processes" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Determine the context for processes using the <code>ps</code> command with the <code>-Z</code> flag:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ps -eZ | head -2</span>
</span></span><span class="line"><span class="cl">LABEL                               PID TTY          TIME CMD
</span></span><span class="line"><span class="cl">system_u:system_r:init_t:s0           <span class="m">1</span> ?        00:00:02 systemd
</span></span></code></pre></div><p>Output:</p>
<ul>
<li>
<p>The subject <em>system_u</em> is a SELinux username (mapped to Linux user root)</p>
</li>
<li>
<p>Object is <em>system_r</em></p>
</li>
<li>
<p>Domain <em>init_t</em> reveals the type of protection applied to the process.</p>
</li>
<li>
<p>Level of security <code>s0</code></p>
</li>
<li>
<p>A process that is unprotected will run in the unconfined_t domain.</p>
</li>
</ul>

<h3 class="relative group">SELinux Contexts for Files
    <div id="selinux-contexts-for-files" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#selinux-contexts-for-files" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><code>ls -Z</code></p>
<ul>
<li>View context for files and directories.</li>
</ul>
<p>Show the four attributes set on the /etc/passwd file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /etc/passwd</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root system_u:object_r:passwd_file_t:s0 <span class="m">2806</span> Jul <span class="m">19</span> 21:54 /etc/passwd
</span></span></code></pre></div><ul>
<li>Subject <em>system_u</em></li>
<li>Object <em>object_r</em></li>
<li>Type <code>passwd_file_t</code></li>
<li>Security level <code>s0</code> for the passwd file.</li>
</ul>
<p><em>/etc/selinux/targeted/contexts/files/file_contexts</em>
<em>/etc/selinux/targeted/contexts/files/file_contexts.local</em></p>
<ul>
<li>Stores contexts for system-installed and user-created files.</li>
<li>Policy files.</li>
<li>Can be updated using the <code>semanage</code> command.</li>
</ul>

<h3 class="relative group">Copying, Moving, and Archiving Files with SELinux Contexts
    <div id="copying-moving-and-archiving-files-with-selinux-contexts" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#copying-moving-and-archiving-files-with-selinux-contexts" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>All files in RHEL are labeled with an SELINUX security context by default.</li>
<li>New files inherit the parent directory&rsquo;s context at the time of creation.</li>
</ul>
<p>Rules for copy move and archive:</p>
<ol>
<li>
<p>If a file is copied to a different directory, the destination file will receive the destination directory&rsquo;s context, unless the <code>--preserve=context</code> switch is specified with the <code>cp</code> command to retain the source file&rsquo;s original context.</p>
</li>
<li>
<p>If a copy operation overwrites the destination file in the same or different directory, the file being copied will receive the context of the overwritten file, unless the <code>--preserve=context</code> switch is specified with the <code>cp</code> command to preserve the source file&rsquo;s original context.</p>
</li>
<li>
<p>If a file is moved to the same or different directory, the SELinux context will remain intact, which may differ from the destination directory&rsquo;s context.</p>
</li>
<li>
<p>If a file is archived with the tar command, use the <code>--selinux</code> option to preserve the context.</p>
</li>
</ol>

<h3 class="relative group">SELinux Contexts for Ports
    <div id="selinux-contexts-for-ports" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#selinux-contexts-for-ports" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>View attributes for network ports with the <code>semanage</code> command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage port -l | head -7</span>
</span></span><span class="line"><span class="cl">SELinux Port Type              Proto    Port Number
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">afs3_callback_port_t           tcp      <span class="m">7001</span>
</span></span><span class="line"><span class="cl">afs3_callback_port_t           udp      <span class="m">7001</span>
</span></span><span class="line"><span class="cl">afs_bos_port_t                 udp      <span class="m">7007</span>
</span></span><span class="line"><span class="cl">afs_fs_port_t                  tcp      <span class="m">2040</span>
</span></span><span class="line"><span class="cl">afs_fs_port_t                  udp      7000, <span class="m">7005</span>
</span></span></code></pre></div><ul>
<li>By default, SELinux allows services to listen on a restricted set of network ports only.</li>
</ul>

<h2 class="relative group">Domain Transitioning
    <div id="domain-transitioning" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#domain-transitioning" aria-label="Anchor">#</a>
    </span>
    
</h2>
<ul>
<li>SELinux allows a process running in one domain to enter another domain to execute an application that is restricted to run in that domain only.</li>
<li>A rule must exist in the policy to support such transition.</li>
<li><strong>entrypoint</strong>
<ul>
<li>Permission setting</li>
<li>Control processes that can transition into another domain.</li>
</ul>
</li>
</ul>
<p>Example:
What happens when a Linux user attempts to change their password using the <code>/usr/bin/passwd</code> command.</p>
<p>The <code>passwd</code> command is labeled with the passwd_exec_t type:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /usr/bin/passwd</span>
</span></span><span class="line"><span class="cl">-rwsr-xr-x. <span class="m">1</span> root root system_u:object_r:passwd_exec_t:s0 <span class="m">32648</span> Aug <span class="m">10</span>  <span class="m">2021</span> /usr/bin/passwd
</span></span></code></pre></div><p>The <code>passwd</code> command requires access to the <code>/etc/shadow</code> file in order to modify a user password. The shadow file has a different type set on it
(<em>shadow_t</em>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">**<span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /etc/shadow</span>
</span></span><span class="line"><span class="cl">----------. <span class="m">1</span> root root system_u:object_r:shadow_t:s0 <span class="m">2756</span> Jul <span class="m">19</span> 21:54 /etc/shadow
</span></span></code></pre></div><ul>
<li>The SELinux policy has rules that specifically allow processes running in domain <em>passwd_t</em> to read and modify the files with type <em>shadow_t</em>, and allow them <strong>entrypoint</strong> permission into domain <em>passwd_exec_t</em>.</li>
<li>This rule enables the user&rsquo;s shell process executing the <code>passwd</code> command to switch into the <em>passwd_t</em> domain and update the shadow file.</li>
</ul>
<p>Open two terminal windows. In window 1, issue the passwd command as
user1 and wait at the prompt:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>user1@server30 root<span class="o">]</span>$ passwd
</span></span><span class="line"><span class="cl">Changing password <span class="k">for</span> user user1.
</span></span><span class="line"><span class="cl">Current password: 
</span></span></code></pre></div><p>In window 2, run the ps command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ps -eZ | grep passwd</span>
</span></span><span class="line"><span class="cl">unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023 <span class="m">13001</span> pts/1 00:00:00 passwd
</span></span></code></pre></div><ul>
<li>The <code>passwd</code> command (process) transitioned into the <em>passwd_t</em> domain to change the user password.</li>
</ul>

<h2 class="relative group">SELinux Booleans
    <div id="selinux-booleans" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#selinux-booleans" aria-label="Anchor">#</a>
    </span>
    
</h2>
<ul>
<li>on/off switches that SELinux uses to determine whether to permit an action.</li>
<li>Activate or deactivate certain rule in the SELinux policy immediately and without the need to recompile or reload the policy.</li>
<li>For instance, the <em>ftpd_anon_write</em> Boolean can be turned on to enable anonymous users to upload files.</li>
<li>This privilege can be revoked by turning this Boolean off.</li>
<li>Boolean values are stored in virtual files located in <em>/sys/fs/selinux/booleans/</em>.</li>
<li>The filenames match the Boolean names.</li>
</ul>
<p>A sample listing of this directory is provided below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -l /sys/fs/selinux/booleans/ | head -7</span>
</span></span><span class="line"><span class="cl">total <span class="m">0</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 abrt_anon_write
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 abrt_handle_event
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 abrt_upload_watch_anon_write
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 antivirus_can_scan_system
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 antivirus_use_jit
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 auditadm_exec_content
</span></span></code></pre></div><ul>
<li>
<p>The manual pages of the Booleans are available through the <code>selinux-policy-doc</code> package.</p>
</li>
<li>
<p>Once installed, use the <code>-K</code> option with the <code>man</code> command to bring the pages up for a specific Boolean.</p>
</li>
<li>
<p>For instance, issue <code>man -K abrt_anon_write</code> to view the manual pages for the <code>abrt_anon_write</code> Boolean.</p>
</li>
<li>
<p>Can be viewed, and flipped temporarily or for permanence.</p>
</li>
<li>
<p>New value takes effect right away.</p>
</li>
<li>
<p>Temporary changes are stored as a &ldquo;1&rdquo; or &ldquo;0&rdquo; in the corresponding Boolean file in the <em>/sys/fs/selinux/booleans/</em></p>
</li>
<li>
<p>Permanent changes are saved in the policy database.</p>
</li>
</ul>

<h2 class="relative group">SELinux Administration
    <div id="selinux-administration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#selinux-administration" aria-label="Anchor">#</a>
    </span>
    
</h2>
<ul>
<li>Controlling the activation mode, checking operational status, setting security contexts on subjects and objects, and switching Boolean values.</li>
</ul>
<p>Utilities and the commands they provide</p>
<ul>
<li><code>libselinux-utils</code>
<ul>
<li><code>getenforce</code></li>
<li><code>getsebool</code></li>
</ul>
</li>
<li><code>policycoreutils</code>
<ul>
<li><code>sestatus</code></li>
<li><code>setsebool</code></li>
<li><code>restorecon</code></li>
</ul>
</li>
<li><code>policycoreutils-python-utils</code>
<ul>
<li><code>semanage</code></li>
</ul>
</li>
<li><code>setools-console</code>
<ul>
<li><code>seinfo</code></li>
<li><code>sesearch</code></li>
</ul>
</li>
</ul>
<p><strong>SELinux Alert Browser</strong></p>
<ul>
<li>
<p>Graphical tool for viewing alerts and debugging SELinux issues.</p>
</li>
<li>
<p>Part of the <code>setroubleshoot-server</code> package.</p>
</li>
<li>
<p>In order to fully manage SELinux, you need to ensure that all these packages are installed on the system.</p>
</li>
</ul>

<h3 class="relative group">Management Commands
    <div id="management-commands" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#management-commands" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>SELinux delivers a variety of commands for effective administration.
Table 20-1 lists and describes the commands mentioned above plus a few more under various management categories.</p>
<p><strong>Mode Management</strong></p>
<p><code>getenforce</code></p>
<ul>
<li>Displays the current mode of operation</li>
</ul>
<p><code>grubby</code></p>
<ul>
<li>Updates and displays information about the configuration files for the grub2 boot loader</li>
</ul>
<p><code>sestatus</code></p>
<ul>
<li>Shows SELinux runtime status and Boolean values</li>
</ul>
<p><code>setenforce</code></p>
<ul>
<li>Switches the operating mode between enforcing and permissive temporarily</li>
</ul>
<p><strong>Context Management</strong></p>
<p><code>chcon</code></p>
<ul>
<li>Changes context on files (changes do not survive file system relabeling)</li>
</ul>
<p><code>restorecon</code></p>
<ul>
<li>Restores default contexts on files by referencing the files in  <em>/etc/selinux/targeted/contexts/files/</em></li>
</ul>
<p><code>semanage </code></p>
<ul>
<li>Changes context on files with the <code>fcontext</code> subcommand (changes survive file system relabeling)</li>
</ul>
<p><strong>Policy Management</strong></p>
<p><code>seinfo </code></p>
<ul>
<li>Provides information on policy components</li>
</ul>
<p><code>semanage</code></p>
<ul>
<li>Manages policy database</li>
</ul>
<p><code>sesearch</code></p>
<ul>
<li>Searches rules in the policy database</li>
</ul>
<p><strong>Boolean Management</strong></p>
<p><code>getsebool</code></p>
<ul>
<li>Displays Booleans and their current settings.</li>
</ul>
<p><code>setsebool</code></p>
<ul>
<li>Modifies Boolean values temporarily, or in the policy database.</li>
</ul>
<p><code>semanage</code></p>
<ul>
<li>Modifies Boolean values in the policy database with the <code>boolean</code>subcommand.</li>
</ul>
<p><strong>Troubleshooting</strong></p>
<p><code>sealert</code></p>
<ul>
<li>The graphical troubleshooting tool</li>
</ul>

<h3 class="relative group">Viewing and Controlling SELinux Operational State
    <div id="viewing-and-controlling-selinux-operational-state" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#viewing-and-controlling-selinux-operational-state" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><em>/etc/selinux/config</em></p>
<ul>
<li>One of the key configuration files that controls the SELinux operational state, and sets its default type</li>
</ul>
<p>The default content of the file is displayed below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cat /etc/selinux/config</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># This file controls the state of SELinux on the system.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># SELINUX= can take one of these three values:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     enforcing - SELinux security policy is enforced.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     permissive - SELinux prints warnings instead of enforcing.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     disabled - No SELinux policy is loaded.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># See also:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/changing-selinux-states-and-modes_using-selinux#changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># NOTE: Up to RHEL 8 release included, SELINUX=disabled would also</span>
</span></span><span class="line"><span class="cl"><span class="c1"># fully disable SELinux during boot. If you need a system with SELinux</span>
</span></span><span class="line"><span class="cl"><span class="c1"># fully disabled instead of SELinux running with no policy loaded, you</span>
</span></span><span class="line"><span class="cl"><span class="c1"># need to pass selinux=0 to the kernel command line. You can use grubby</span>
</span></span><span class="line"><span class="cl"><span class="c1"># to persistently set the bootloader to boot with selinux=0:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    grubby --update-kernel ALL --args selinux=0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To revert back to SELinux enabled:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    grubby --update-kernel ALL --remove-args selinux</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="nv">SELINUX</span><span class="o">=</span>enforcing
</span></span><span class="line"><span class="cl"><span class="c1"># SELINUXTYPE= can take one of these three values:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     targeted - Targeted processes are protected,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     minimum - Modification of targeted policy. Only selected processes are protected.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     mls - Multi Level Security protection.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SELINUXTYPE</span><span class="o">=</span>targeted
</span></span></code></pre></div><p>Directives:</p>
<p><strong>SELINUX</strong></p>
<ul>
<li>Sets the activation mode for SELinux.</li>
<li><em>Enforcing</em> activates it and allows or denies actions based on the policy rules.</li>
<li><em>Permissive</em> activates SELinux, but permits all actions.
<ul>
<li>It records all security violations.</li>
<li>Useful for troubleshooting and developing or tuning the policy.</li>
</ul>
</li>
<li>The third option is to completely turn SELinux off. When running in enforcing mode</li>
</ul>
<p><strong>SELINUXTYPE</strong></p>
<ul>
<li>Dictates the type of policy to be enforced.</li>
<li>Default is targeted.</li>
</ul>
<p>Determine the current operating mode:
<code>getenforce</code></p>
<p>Change the state to permissive and verify:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># setenforce permissive</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getenforce</span>
</span></span><span class="line"><span class="cl">Permissive
</span></span></code></pre></div><ul>
<li>Can also &ldquo;0&rdquo; for permissive and a &ldquo;1&rdquo; for enforcing.</li>
<li>Changes will be lost at the next system reboot.</li>
<li>Edit  <em>/etc/selinux/config</em> <strong>SELINUX</strong> directive to the desired mode for persistence.</li>
</ul>
<p>EXAM TIP: You may switch SELinux to permissive for troubleshooting a
non-functioning service. Don&rsquo;t forget to change it back to enforcing
when the issue is resolved.</p>
<p>Disable SELinux persistently:
<code>grubby --update-kernel ALL --args selinux=0</code></p>
<ul>
<li>Appends the selinux=0 setting to the end of the &ldquo;options&rdquo; line in the bootloader configuration file located in the /boot/loader/entries directory:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat /boot/loader/entries/dcb323fab47049e8b89dae2ae00d41e8-5.14.0-427.26.1.el9_4.x86_64.conf 
</span></span></code></pre></div><p>Revert the above:
<code>grubby --update-kernel ALL --remove-args selinux=0</code></p>

<h3 class="relative group">Querying Status
    <div id="querying-status" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#querying-status" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><code>sestatus</code> Command</p>
<ul>
<li>View the current runtime status of SELinux</li>
<li>Displays the location of principal directories, the policy in effect, and the activation mode.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># sestatus</span>
</span></span><span class="line"><span class="cl">SELinux status:                 enabled
</span></span><span class="line"><span class="cl">SELinuxfs mount:                /sys/fs/selinux
</span></span><span class="line"><span class="cl">SELinux root directory:         /etc/selinux
</span></span><span class="line"><span class="cl">Loaded policy name:             targeted
</span></span><span class="line"><span class="cl">Current mode:                   permissive
</span></span><span class="line"><span class="cl">Mode from config file:          enforcing
</span></span><span class="line"><span class="cl">Policy MLS status:              enabled
</span></span><span class="line"><span class="cl">Policy deny_unknown status:     allowed
</span></span><span class="line"><span class="cl">Memory protection checking:     actual <span class="o">(</span>secure<span class="o">)</span>
</span></span><span class="line"><span class="cl">Max kernel policy version:      <span class="m">33</span>
</span></span></code></pre></div><p><code>-v </code></p>
<ul>
<li>Report on security contexts set on files and processes, as listed in <em>/etc/sestatus.conf</em> .</li>
<li>Reports the contexts for the current process (Current context) and the init (systemd) process (Init context) under Process Contexts.</li>
<li>Reveals the file contexts for the controlling terminal and associated files under File Contexts.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cat /etc/sestatus.conf</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>files<span class="o">]</span>
</span></span><span class="line"><span class="cl">/etc/passwd
</span></span><span class="line"><span class="cl">/etc/shadow
</span></span><span class="line"><span class="cl">/bin/bash
</span></span><span class="line"><span class="cl">/bin/login
</span></span><span class="line"><span class="cl">/bin/sh
</span></span><span class="line"><span class="cl">/sbin/agetty
</span></span><span class="line"><span class="cl">/sbin/init
</span></span><span class="line"><span class="cl">/sbin/mingetty
</span></span><span class="line"><span class="cl">/usr/sbin/sshd
</span></span><span class="line"><span class="cl">/lib/libc.so.6
</span></span><span class="line"><span class="cl">/lib/ld-linux.so.2
</span></span><span class="line"><span class="cl">/lib/ld.so.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>process<span class="o">]</span>
</span></span><span class="line"><span class="cl">/sbin/mingetty
</span></span><span class="line"><span class="cl">/sbin/agetty
</span></span><span class="line"><span class="cl">/usr/sbin/sshd
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># sestatus -v</span>
</span></span><span class="line"><span class="cl">SELinux status:                 enabled
</span></span><span class="line"><span class="cl">SELinuxfs mount:                /sys/fs/selinux
</span></span><span class="line"><span class="cl">SELinux root directory:         /etc/selinux
</span></span><span class="line"><span class="cl">Loaded policy name:             targeted
</span></span><span class="line"><span class="cl">Current mode:                   permissive
</span></span><span class="line"><span class="cl">Mode from config file:          enforcing
</span></span><span class="line"><span class="cl">Policy MLS status:              enabled
</span></span><span class="line"><span class="cl">Policy deny_unknown status:     allowed
</span></span><span class="line"><span class="cl">Memory protection checking:     actual <span class="o">(</span>secure<span class="o">)</span>
</span></span><span class="line"><span class="cl">Max kernel policy version:      <span class="m">33</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Process contexts:
</span></span><span class="line"><span class="cl">Current context:                unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
</span></span><span class="line"><span class="cl">Init context:                   system_u:system_r:init_t:s0
</span></span><span class="line"><span class="cl">/sbin/agetty                    system_u:system_r:getty_t:s0-s0:c0.c1023
</span></span><span class="line"><span class="cl">/usr/sbin/sshd                  system_u:system_r:sshd_t:s0-s0:c0.c1023
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">File contexts:
</span></span><span class="line"><span class="cl">Controlling terminal:           unconfined_u:object_r:user_devpts_t:s0
</span></span><span class="line"><span class="cl">/etc/passwd                     system_u:object_r:passwd_file_t:s0
</span></span><span class="line"><span class="cl">/etc/shadow                     system_u:object_r:shadow_t:s0
</span></span><span class="line"><span class="cl">/bin/bash                       system_u:object_r:shell_exec_t:s0
</span></span><span class="line"><span class="cl">/bin/login                      system_u:object_r:login_exec_t:s0
</span></span><span class="line"><span class="cl">/bin/sh                         system_u:object_r:bin_t:s0 -&gt; system_u:object_r:shell_exec_t:s0
</span></span><span class="line"><span class="cl">/sbin/agetty                    system_u:object_r:getty_exec_t:s0
</span></span><span class="line"><span class="cl">/sbin/init                      system_u:object_r:bin_t:s0 -&gt; system_u:object_r:init_exec_t:s0
</span></span><span class="line"><span class="cl">/usr/sbin/sshd                  system_u:object_r:sshd_exec_t:s0
</span></span></code></pre></div>
<h3 class="relative group">Lab: Modify SELinux File Context
    <div id="lab-modify-selinux-file-context" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-modify-selinux-file-context" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Create a directory sedir1 under /tmp and a file sefile1 under sedir1.</li>
<li>Check the context on the directory and file.</li>
<li>Change the SELinux user and type to user_u and public_content_t on both and verify.</li>
</ul>
<p>1. Create the hierarchy sedir1/sefile1 under /tmp:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cd /tmp</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># mkdir sedir1</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># touch sedir1/sefile1</span>
</span></span></code></pre></div><p>2. Determine the context on the new directory and file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1</span>
</span></span><span class="line"><span class="cl"> drwxr-xr-x. <span class="m">2</span> root root  unconfined_u:object_r:user_tmp_t:s0 <span class="m">21</span> Jul <span class="m">28</span> 15:12  sedir1 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1/sefile1</span>
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root  unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">28</span> 15:12  sedir1/sefile1
</span></span></code></pre></div><p>3. Modify the SELinux user (<code>-u</code>) on the directory to <code>user_u</code> and type
(<code>-t</code>) to <code>public_content_t</code> recursively (<code>-R</code>) with the <code>chcon</code> command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># chcon -vu user_u -t  public_content_t sedir1 -R</span>
</span></span><span class="line"><span class="cl"> changing security context of <span class="s1">&#39;sedir1/sefile1&#39;</span>
</span></span><span class="line"><span class="cl"> changing security context of <span class="s1">&#39;sedir1&#39;</span>
</span></span></code></pre></div><p>4. Validate the new context:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1</span>
</span></span><span class="line"><span class="cl"> drwxr-xr-x. <span class="m">2</span> root root  user_u:object_r:public_content_t:s0 <span class="m">21</span> Jul <span class="m">28</span> 15:12  sedir1
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1/sefile1</span>
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root  user_u:object_r:public_content_t:s0 <span class="m">0</span> Jul <span class="m">28</span> 15:12  sedir1/sefile1
</span></span></code></pre></div>
<h3 class="relative group">Lab: Add and Apply File Context
    <div id="lab-add-and-apply-file-context" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-add-and-apply-file-context" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Add the current context on sedir1 to the SELinux policy database to ensure a relabeling will not reset it to its previous value</li>
<li>Change the context on the directory to some random values.</li>
<li>Restore the default context from the policy database back to the directory recursively.</li>
</ul>
<ol>
<li>Determine the current context:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1</span>
</span></span><span class="line"><span class="cl"> drwxr-xr-x. <span class="m">2</span> root root  user_u:object_r:public_content_t:s0 <span class="m">21</span> Jul <span class="m">28</span> 15:12  sedir1
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1/sefile1</span>
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root  user_u:object_r:public_content_t:s0 <span class="m">0</span> Jul <span class="m">28</span> 15:12  sedir1/sefile1
</span></span></code></pre></div><ol start="2">
<li>Add (-a) the directory recursively to the policy database using the <code>semanage</code> command with the <code>fcontext</code> subcommand:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># semanage fcontext -a -s user_u -t public_content_t &#34;/tmp/sedir1(/.*)?&#34;</span>
</span></span></code></pre></div><ul>
<li>The regular expression (/.*)? instructs the command to include all files and subdirectories under /tmp/sedir1.
<ul>
<li>Needed only if recursion is required.</li>
</ul>
</li>
</ul>
<p>The above command added the context to the <em>/etc/selinux/targeted/contexts/files/file_contexts.local file</em>.</p>
<ol>
<li>Validate the addition by listing (-l) the recent changes (-C) in the policy database:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># semanage fcontext -Cl | grep  sedir</span>
</span></span><span class="line"><span class="cl"> /tmp/sedir1<span class="o">(</span>/.*<span class="o">)</span>?                                   all files           user_u:object_r:public_content_t:s0 
</span></span></code></pre></div><ol start="2">
<li>Change the current context on sedir1 to something random (staff_u/etc_t) with the <code>chcon</code> command:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> root@server30 tmp<span class="o">]</span><span class="c1"># chcon -vu staff_u -t etc_t  sedir1 -R</span>
</span></span><span class="line"><span class="cl"> changing security context of <span class="s1">&#39;sedir1/sefile1&#39;</span>
</span></span><span class="line"><span class="cl"> changing security context of <span class="s1">&#39;sedir1&#39;</span>
</span></span></code></pre></div><ol>
<li>The security context is changed successfully. Confirm with the <code>ls</code> command:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1 ; ls -lZ  sedir1/sefile1</span>
</span></span><span class="line"><span class="cl"> drwxr-xr-x. <span class="m">2</span> root root staff_u:object_r:etc_t:s0  <span class="m">21</span> Jul <span class="m">28</span> 15:12 sedir1
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root staff_u:object_r:etc_t:s0 <span class="m">0</span>  Jul <span class="m">28</span> 15:12 sedir1/sefile1
</span></span></code></pre></div><ol>
<li>Reinstate the context on the sedir1 directory recursively (<code>-R</code>) as stored in the policy database using the <code>restorecon</code> command: (-F option will update all attributes, only does type by default. )</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ restorecon -R -v -F sedir1
</span></span><span class="line"><span class="cl">Relabeled /tmp/sedir1 from unconfined_u:object_r:public_content_t:s0 to user_u:object_r:public_content_t:s0
</span></span><span class="line"><span class="cl">Relabeled /tmp/sedir1/sefile1 from unconfined_u:object_r:public_content_t:s0 to user_u:object_r:public_content_t:s0
</span></span></code></pre></div>
<h3 class="relative group">Lab: Add and Delete Network Ports
    <div id="lab-add-and-delete-network-ports" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-add-and-delete-network-ports" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Add a non-standard network port 8010 to the SELinux policy database for the httpd service.</li>
<li>Confirm the addition.</li>
<li>Remove the port from the policy and verify the deletion.</li>
</ul>
<ol start="2">
<li>List (<code>-l</code>) the ports for the httpd service as defined in the SELinux policy database:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage port -l | grep ^http_port</span>
</span></span><span class="line"><span class="cl"> http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, <span class="m">9000</span>
</span></span></code></pre></div><p>The output reveals eight network ports the httpd process is currently allowed to listen on.</p>
<ol>
<li>Add port 8010 with type <code>http_port_t</code> and protocol tcp to the policy:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage port -at http_port_t -p  tcp 8010</span>
</span></span></code></pre></div><ol start="2">
<li>Confirm the addition:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage port -l | grep ^http_port</span>
</span></span><span class="line"><span class="cl"> http_port_t                    tcp      8010, 80,  81, 443, 488, 8008, 8009, 8443, <span class="m">9000</span>
</span></span></code></pre></div><ol>
<li>Delete port <code>8010</code> from the policy and confirm:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage port -dp tcp 8010</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage port -l | grep ^http_port</span>
</span></span><span class="line"><span class="cl"> http_port_t                    tcp      80, 81,  443, 488, 8008, 8009, 8443, <span class="m">9000</span>
</span></span></code></pre></div><p>EXAM TIP: Any non-standard port you want to use for any service, make certain to add it to the SELinux policy database with the correct type.</p>

<h3 class="relative group">Lab: Copy Files with and without Context
    <div id="lab-copy-files-with-and-without-context" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-copy-files-with-and-without-context" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Create a file called sefile2 under /tmp and display its context.</li>
<li>Copy this file to the /etc/default directory, and observe the change in the context.</li>
<li>Remove sefile2 from /etc/default, and copy it again to the same destination, ensuring that the target file receives the source file&rsquo;s context.</li>
</ul>
<p>1. Create file sefile2 under /tmp and show context:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># touch /tmp/sefile2</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># ls -lZ /tmp/sefile2</span>
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root  unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 08:44  /tmp/sefile2
</span></span></code></pre></div><p>2. Copy this file to the /etc/default directory, and check the context again:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># cp /tmp/sefile2 /etc/default/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># ls -lZ /etc/default/sefile2</span>
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root  unconfined_u:object_r:etc_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 08:45  /etc/default/sefile2
</span></span></code></pre></div><p>3. Erase the <em>/etc/default/sefile2</em> file, and copy it again with the <code>--preserve=context</code> option:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># rm /etc/default/sefile2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># cp --preserve=context  /tmp/sefile2 /etc/default</span>
</span></span></code></pre></div><p>4. List the file to view the context:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># ls -lZ /etc/default/sefile2</span>
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root  unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 08:49  /etc/default/sefile2
</span></span></code></pre></div>
<h3 class="relative group">Exercise 20-5: View and Toggle SELinux Boolean Values
    <div id="exercise-20-5-view-and-toggle-selinux-boolean-values" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#exercise-20-5-view-and-toggle-selinux-boolean-values" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Display the current state of the Boolean <code>nfs_export_all_rw</code>.</li>
<li>Toggle its value temporarily, and reboot the system.</li>
<li>Flip its value persistently after the system has been back up.</li>
</ul>
<p>1. Display the current setting of the Boolean <code>nfs_export_all_rw</code> using three different commands&mdash;<code>getsebool</code>, <code>sestatus</code>, and <code>semanage</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># getsebool -a | grep  nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl"> nfs_export_all_rw --&gt; on
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># sestatus -b | grep  nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl"> nfs_export_all_rw                           on
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage boolean -l | grep  nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl"> nfs_export_all_rw              <span class="o">(</span>on   ,   on<span class="o">)</span>  Allow  nfs to <span class="nb">export</span> all rw
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># </span>
</span></span></code></pre></div><p>2. Turn off the value of <code>nfs_export_all_rw</code> using the setsebool command by simply furnishing &ldquo;<code>off</code>&rdquo; or &ldquo;<code>0</code>&rdquo; with it and confirm:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># setsebool nfs_export_all_rw 0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># getsebool -a | grep  nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl"> nfs_export_all_rw --&gt; off
</span></span></code></pre></div><p>3. Reboot the system and rerun the <code>getsebool</code> command to check the Boolean state:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># getsebool -a | grep  nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl"> nfs_export_all_rw --&gt; on
</span></span></code></pre></div><p>4. Set the value of the Boolean persistently (<code>-P</code> or <code>-m</code> as needed) using either of the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># setsebool -P nfs_export_all_rw off</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage boolean -m -0  nfs_export_all_rw</span>
</span></span></code></pre></div><p>5. Validate the new value using the getsebool, sestatus, or semanage command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># sestatus -b | grep  nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl"> nfs_export_all_rw                           off
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage boolean -l | grep  nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl"> nfs_export_all_rw              <span class="o">(</span>off  ,  off<span class="o">)</span>  Allow  nfs to <span class="nb">export</span> all rw
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage boolean -l | grep  nfs_export_all_rw </span>
</span></span><span class="line"><span class="cl"> nfs_export_all_rw              <span class="o">(</span>off  ,  off<span class="o">)</span>  Allow  nfs to <span class="nb">export</span> all rw
</span></span></code></pre></div>
<h3 class="relative group">Monitoring and Analyzing SELinux Violations
    <div id="monitoring-and-analyzing-selinux-violations" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#monitoring-and-analyzing-selinux-violations" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>
<p>SELinux generates alerts for system activities when it runs in enforcing or permissive mode.</p>
</li>
<li>
<p>It writes the alerts to <em>/var/log/audit/audit.log</em>if the <strong>auditd</strong> daemon is running, or to <em>/var/log/messages</em> via the <strong>rsyslog</strong> daemon in the absence of <strong>auditd</strong>.</p>
</li>
<li>
<p>SELinux also logs the alerts that are generated due to denial of an action, and identifies them with a type tag <strong>AVC (Access Vector Cache)</strong> in the audit.log file.</p>
</li>
<li>
<p>It also writes the rejection in the messages file with a message ID, and how to view the message details.</p>
</li>
<li>
<p>SELinux denial messages are analyzed, and the audit data is examined to identify the potential cause of the rejection.</p>
</li>
<li>
<p>The results of the analysis are recorded with recommendations on how to fix it.</p>
</li>
<li>
<p>These results can be reviewed to aid in troubleshooting, and recommended actions taken to address the issue.</p>
</li>
<li>
<p>SELinux runs a service daemon called <strong>setroubleshootd</strong> that performs this analysis and examination in the background.</p>
</li>
<li>
<p>This service also has a client interface called <strong>SELinux Troubleshooter</strong> (the <code>sealert</code> command) that reads the data and displays it for assessment.</p>
</li>
<li>
<p>The client tool has both text and graphical interfaces.</p>
</li>
<li>
<p>The server and client components are part of the <code>setroubleshoot-server</code> software package that must be installed on the system prior to using this service.</p>
</li>
</ul>
<p>How SELinux handles an incoming access request (from a subject) to a target object:</p>
<p>Subject (eg: a process) makes an Action request (eg: read) &gt; SELinux Security Server checks the SELinux Policy Database &gt; if permission is not granted the AVC Denied Message is diaplayed. If Permission is granted, then access to object (eg: a file) is granted.</p>
<p>su to root from user1 and view the log:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># cat /var/log/audit/audit.log |  tail -10</span>
</span></span><span class="line"><span class="cl"> ...
</span></span><span class="line"><span class="cl"> <span class="nv">type</span><span class="o">=</span>USER_START <span class="nv">msg</span><span class="o">=</span>audit<span class="o">(</span>1722274070.748:90<span class="o">)</span>:  <span class="nv">pid</span><span class="o">=</span><span class="m">1394</span> <span class="nv">uid</span><span class="o">=</span><span class="m">1000</span> <span class="nv">auid</span><span class="o">=</span><span class="m">0</span> <span class="nv">ses</span><span class="o">=</span><span class="m">1</span>  <span class="nv">subj</span><span class="o">=</span>unconfined_u:unconfined_r:unconfined_t:s0- s0:c0.c1023 <span class="nv">msg</span><span class="o">=</span><span class="s1">&#39;op=PAM:session_open  grantors=pam_keyinit,pam_limits,pam_systemd,pam_unix, pam_umask,pam_xauth acct=&#34;root&#34; exe=&#34;/usr/bin/su&#34;  hostname=? addr=? terminal=/dev/pts/0  res=success&#39;</span><span class="nv">UID</span><span class="o">=</span><span class="s2">&#34;user1&#34;</span> <span class="nv">AUID</span><span class="o">=</span><span class="s2">&#34;root&#34;</span>
</span></span></code></pre></div><p>WIll show avc denied if denied.</p>

<h3 class="relative group">Lab Get an AVC deny message
    <div id="lab-get-an-avc-deny-message" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-get-an-avc-deny-message" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Change the SELinux type on the shadow file to something random (etc_t).</li>
<li>Issue the <code>passwd</code> command as user1 to modify the password.</li>
<li>Restored the type on the shadow file with <code>restorecon /etc/shadow</code>. '</li>
<li>Re-try the password change.</li>
</ul>
<ol start="2">
<li>Change the SELinux type on <em>/etc/shadow</em> to something random (etc_t)</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># chcon -vt etc_t /etc/shadow</span>
</span></span><span class="line"><span class="cl"> changing security context of <span class="s1">&#39;/etc/shadow&#39;</span>
</span></span></code></pre></div><ol start="3">
<li>Issue the <code>passwd</code> command as user1 to modify the password:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># su user1</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>user1@server10 root<span class="o">]</span>$ passwd
</span></span><span class="line"><span class="cl"> Changing password <span class="k">for</span> user user1.
</span></span><span class="line"><span class="cl"> Current password: 
</span></span><span class="line"><span class="cl"> roopasswd: Authentication token manipulation error
</span></span></code></pre></div><p>The following is a sample denial record from the same file in raw format:</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="low"
    alt=""
    src="../../../img/image-C7TMRBJO%201.jpg"
    ></figure>
<ul>
<li>AVC type</li>
<li>Related to the <code>passwd</code> command (comm)</li>
<li>Source context (<code>scontext</code>) <code>unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023</code></li>
<li><em>nshadow</em> file (name) with file type (<em>tclass</em>) &ldquo;file&rdquo;</li>
<li>Target context (tcontext) <code>system_u:object_r:etc_t:s0</code></li>
<li>Indicates the SELinux operating mode, which is enforcing <code>permissive=0</code>.</li>
<li>This message indicates that the <em>/etc/shadow</em> file does not have the correct context set on it, and that&rsquo;s why SELinux prevented the <code>passwd</code> command from updating the user&rsquo;s password.</li>
</ul>
<p>Use <code>sealert</code> to analyze (<code>-a</code>) all <strong>AVC</strong> records in the <em>audit.log</em> file. This command produces a formatted report with all relevant details:</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="low"
    alt=""
    src="../../../img/image-WYWDQX1V%201.jpg"
    ></figure>

<h2 class="relative group">SELinux DIY Labs
    <div id="selinux-diy-labs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#selinux-diy-labs" aria-label="Anchor">#</a>
    </span>
    
</h2>

<h3 class="relative group">Lab: Disable and Enable the SELinux Operating Mode
    <div id="lab-disable-and-enable-the-selinux-operating-mode" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-disable-and-enable-the-selinux-operating-mode" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Check and make a note of the current SELinux operating mode.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getenforce</span>
</span></span><span class="line"><span class="cl"> Enforcing
</span></span></code></pre></div><ul>
<li>Modify the configuration file and set the mode to disabled.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># vim /etc/selinux/config </span>
</span></span><span class="line"><span class="cl"> <span class="nv">SELINUX</span><span class="o">=</span>disabled
</span></span></code></pre></div><ul>
<li>Reboot the system to apply the change.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># reboot</span>
</span></span></code></pre></div><ul>
<li>Run <code>sudo getenforce</code> to confirm the change when the system is up.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getenforce</span>
</span></span><span class="line"><span class="cl"> Disabled
</span></span></code></pre></div><ul>
<li>Restore the directive&rsquo;s value to enforcing in the configuration file, and reboot to apply the new mode.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># vim /etc/selinux/config</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="nv">SELINUX</span><span class="o">=</span>enforcing
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># reboot</span>
</span></span></code></pre></div><ul>
<li>Run <code>sudo getenforce</code> to confirm the mode when the system is up.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getenforce</span>
</span></span><span class="line"><span class="cl"> Enforcing
</span></span></code></pre></div>
<h3 class="relative group">Lab: Modify Context on Files
    <div id="lab-modify-context-on-files" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-modify-context-on-files" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Create directory hierarchy <em>/tmp/d1/d2</em>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> mkdir -p /tmp/d1/d2
</span></span></code></pre></div><ul>
<li>Check the contexts on <em>/tmp/d1</em> and <em>/tmp/d1/d2</em>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 d1<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1</span>
</span></span><span class="line"><span class="cl"> drwxr-xr-x. <span class="m">3</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">16</span> Jul <span class="m">29</span> 13:17 /tmp/d1
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 d1<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1/d2</span>
</span></span><span class="line"><span class="cl"> drwxr-xr-x. <span class="m">2</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">6</span> Jul <span class="m">29</span>  13:17 /tmp/d1/d2
</span></span></code></pre></div><ul>
<li>Change the SELinux type on <em>/tmp/d1</em> to <code>etc_t</code> recursively with the <code>chcon</code> command and confirm.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># chcon -Rv -t etc_t /tmp/d1</span>
</span></span><span class="line"><span class="cl"> changing security context of <span class="s1">&#39;/tmp/d1/d2&#39;</span>
</span></span><span class="line"><span class="cl"> changing security context of <span class="s1">&#39;/tmp/d1&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1</span>
</span></span><span class="line"><span class="cl"> drwxr-xr-x. <span class="m">3</span> root root unconfined_u:object_r:etc_t:s0 <span class="m">16</span> Jul <span class="m">29</span>  13:17 /tmp/d1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1/d2</span>
</span></span><span class="line"><span class="cl"> drwxr-xr-x. <span class="m">2</span> root root unconfined_u:object_r:etc_t:s0 <span class="m">6</span> Jul <span class="m">29</span> 13:17 /tmp/d1/d2
</span></span></code></pre></div><ul>
<li>Add <em>/tmp/d1</em> to the policy database with the <code>semanage</code> command to ensure the new context is persistent on the directory hierarchy.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># semanage fcontext -a -t etc_t /tmp/d1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># reboot</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1</span>
</span></span><span class="line"><span class="cl"> drwxr-xr-x. <span class="m">3</span> root root unconfined_u:object_r:etc_t:s0 <span class="m">16</span> Jul <span class="m">29</span>  13:17 /tmp/d1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1/d2</span>
</span></span><span class="line"><span class="cl"> drwxr-xr-x. <span class="m">2</span> root root unconfined_u:object_r:etc_t:s0 <span class="m">6</span> Jul <span class="m">29</span> 13:17 /tmp/d1/d2
</span></span></code></pre></div>
<h3 class="relative group">Lab: Add Network Port to Policy Database
    <div id="lab-add-network-port-to-policy-database" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-add-network-port-to-policy-database" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Add network port 9005 to the SELinux policy database for the secure HTTP service using the semanage command.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage port -l | grep ^http_port</span>
</span></span><span class="line"><span class="cl"> http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, <span class="m">9000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage port -at http_port_t -p tcp 9005</span>
</span></span></code></pre></div><ul>
<li>Verify the addition.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage port -l | grep ^http_port</span>
</span></span><span class="line"><span class="cl"> http_port_t                    tcp      9005, 80, 81, 443, 488, 8008, 8009, 8443, <span class="m">9000</span>
</span></span></code></pre></div>
<h3 class="relative group">Lab: Copy Files with and without Context
    <div id="lab-copy-files-with-and-without-context-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-copy-files-with-and-without-context-1" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Create file <em>sef1</em> under <em>/tmp</em>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># touch /tmp/sef1</span>
</span></span></code></pre></div><ul>
<li>Copy the file to the <em>/usr/local</em> directory.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cp /tmp/sef1 /usr/local</span>
</span></span></code></pre></div><ul>
<li>Check and compare the contexts on both source and destination files.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /tmp/sef1</span>
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">29</span>  13:33 /tmp/sef1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /usr/local/sef1</span>
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:usr_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 13:33 /usr/local/sef1
</span></span></code></pre></div><ul>
<li>Create another file <em>sef2</em> under <em>/tmp</em> and copy it to the <em>/var/local</em> directory using the <code>--preserve=context</code> option with the <code>cp</code> command.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># touch /tmp/sef2</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cp --preserve=context /tmp/sef2 /var/local/</span>
</span></span></code></pre></div><ul>
<li>Check and compare the contexts on both source and destination files.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /tmp/sef2 /var/local/sef2</span>
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">29</span>  13:35 /tmp/sef2
</span></span><span class="line"><span class="cl"> -rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">29</span>  13:36 /var/local/sef2
</span></span></code></pre></div>
<h3 class="relative group">Lab: Flip SELinux Booleans
    <div id="lab-flip-selinux-booleans" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#lab-flip-selinux-booleans" aria-label="Anchor">#</a>
    </span>
    
</h3>
<ul>
<li>Check the current value of Boolean <code>ssh_use_tcpd</code> using the <code>getsebool</code> and <code>sestatus</code> commands.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getsebool -a | grep ssh_use_tcpd</span>
</span></span><span class="line"><span class="cl"> ssh_use_tcpd --&gt; off
</span></span></code></pre></div><ul>
<li>Use the <code>setsebool</code> command and toggle the value of the directive.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># setsebool ssh_use_tcpd 1 </span>
</span></span></code></pre></div><ul>
<li>Confirm the new value with the <code>getsebool</code>, <code>semanage</code>, or <code>sestatus</code> command.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getsebool -a | grep ssh_use_tcpd</span>
</span></span><span class="line"><span class="cl"> ssh_use_tcpd --&gt; on
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># sestatus -b | grep ssh_use_tcpd</span>
</span></span><span class="line"><span class="cl"> ssh_use_tcpd                                on
</span></span><span class="line"><span class="cl"> <span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage boolean -l | grep ssh_use_tcpd </span>
</span></span><span class="line"><span class="cl"> ssh_use_tcpd                   <span class="o">(</span>on   ,  off<span class="o">)</span>  Allow ssh to use tcpd
</span></span></code></pre></div>
          
          
          
        </div>
        
        

        
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://davidwrites.xyz/tech/linux/security-enhanced-linux/&amp;title=Security%20Enhanced%20Linux"
          title="Share on LinkedIn"
          aria-label="Share on LinkedIn">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
</span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://twitter.com/intent/tweet/?url=https://davidwrites.xyz/tech/linux/security-enhanced-linux/&amp;text=Security%20Enhanced%20Linux"
          title="Tweet on Twitter"
          aria-label="Tweet on Twitter">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://bsky.app/intent/compose?text=Security%20Enhanced%20Linux&#43;https://davidwrites.xyz/tech/linux/security-enhanced-linux/"
          title="Post on Bluesky"
          aria-label="Post on Bluesky">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256,232.562c-21.183,-41.196 -78.868,-117.97 -132.503,-155.834c-51.378,-36.272 -70.978,-29.987 -83.828,-24.181c-14.872,6.72 -17.577,29.554 -17.577,42.988c0,13.433 7.365,110.138 12.169,126.281c15.873,53.336 72.376,71.358 124.413,65.574c2.66,-0.395 5.357,-0.759 8.089,-1.097c-2.68,0.429 -5.379,0.796 -8.089,1.097c-76.259,11.294 -143.984,39.085 -55.158,137.972c97.708,101.165 133.908,-21.692 152.484,-83.983c18.576,62.291 39.972,180.718 150.734,83.983c83.174,-83.983 22.851,-126.674 -53.408,-137.969c-2.71,-0.302 -5.409,-0.667 -8.089,-1.096c2.732,0.337 5.429,0.702 8.089,1.096c52.037,5.785 108.54,-12.239 124.413,-65.574c4.804,-16.142 12.169,-112.847 12.169,-126.281c-0,-13.434 -2.705,-36.267 -17.577,-42.988c-12.85,-5.806 -32.45,-12.09 -83.829,24.181c-53.634,37.864 -111.319,114.635 -132.502,155.831Z"/></svg></span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://reddit.com/submit/?url=https://davidwrites.xyz/tech/linux/security-enhanced-linux/&amp;resubmit=true&amp;title=Security%20Enhanced%20Linux"
          title="Submit to Reddit"
          aria-label="Submit to Reddit">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>
</span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://api.whatsapp.com/send?text=https://davidwrites.xyz/tech/linux/security-enhanced-linux/&amp;resubmit=true&amp;title=Security%20Enhanced%20Linux"
          title="Share via WhatsApp"
          aria-label="Share via WhatsApp">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
</span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://t.me/share/url?url=https://davidwrites.xyz/tech/linux/security-enhanced-linux/&amp;resubmit=true&amp;title=Security%20Enhanced%20Linux"
          title="Share via Telegram"
          aria-label="Share via Telegram">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z"/></svg>
</span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://pinterest.com/pin/create/bookmarklet/?url=https://davidwrites.xyz/tech/linux/security-enhanced-linux/&amp;description=Security%20Enhanced%20Linux"
          title="Pin on Pinterest"
          aria-label="Pin on Pinterest">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>
</span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://www.facebook.com/sharer/sharer.php?u=https://davidwrites.xyz/tech/linux/security-enhanced-linux/&amp;quote=Security%20Enhanced%20Linux"
          title="Share on Facebook"
          aria-label="Share on Facebook">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="mailto:?body=https://davidwrites.xyz/tech/linux/security-enhanced-linux/&amp;subject=Security%20Enhanced%20Linux"
          title="Send via email"
          aria-label="Send via email">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>
</span>
        </a>
      
    
      
        <a
          target="_blank"
          class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
          href="https://line.me/R/share?text=https://davidwrites.xyz/tech/linux/security-enhanced-linux/%20Security%20Enhanced%20Linux"
          title="Share on LINE"
          aria-label="Share on LINE">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License -https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path fill="currentColor" d="M311 196.8v81.3c0 2.1-1.6 3.7-3.7 3.7h-13c-1.3 0-2.4-.7-3-1.5l-37.3-50.3v48.2c0 2.1-1.6 3.7-3.7 3.7h-13c-2.1 0-3.7-1.6-3.7-3.7V196.9c0-2.1 1.6-3.7 3.7-3.7h12.9c1.1 0 2.4 .6 3 1.6l37.3 50.3V196.9c0-2.1 1.6-3.7 3.7-3.7h13c2.1-.1 3.8 1.6 3.8 3.5zm-93.7-3.7h-13c-2.1 0-3.7 1.6-3.7 3.7v81.3c0 2.1 1.6 3.7 3.7 3.7h13c2.1 0 3.7-1.6 3.7-3.7V196.8c0-1.9-1.6-3.7-3.7-3.7zm-31.4 68.1H150.3V196.8c0-2.1-1.6-3.7-3.7-3.7h-13c-2.1 0-3.7 1.6-3.7 3.7v81.3c0 1 .3 1.8 1 2.5c.7 .6 1.5 1 2.5 1h52.2c2.1 0 3.7-1.6 3.7-3.7v-13c0-1.9-1.6-3.7-3.5-3.7zm193.7-68.1H327.3c-1.9 0-3.7 1.6-3.7 3.7v81.3c0 1.9 1.6 3.7 3.7 3.7h52.2c2.1 0 3.7-1.6 3.7-3.7V265c0-2.1-1.6-3.7-3.7-3.7H344V247.7h35.5c2.1 0 3.7-1.6 3.7-3.7V230.9c0-2.1-1.6-3.7-3.7-3.7H344V213.5h35.5c2.1 0 3.7-1.6 3.7-3.7v-13c-.1-1.9-1.7-3.7-3.7-3.7zM512 93.4V419.4c-.1 51.2-42.1 92.7-93.4 92.6H92.6C41.4 511.9-.1 469.8 0 418.6V92.6C.1 41.4 42.2-.1 93.4 0H419.4c51.2 .1 92.7 42.1 92.6 93.4zM441.6 233.5c0-83.4-83.7-151.3-186.4-151.3s-186.4 67.9-186.4 151.3c0 74.7 66.3 137.4 155.9 149.3c21.8 4.7 19.3 12.7 14.4 42.1c-.8 4.7-3.8 18.4 16.1 10.1s107.3-63.2 146.5-108.2c27-29.7 39.9-59.8 39.9-93.1z" /></svg></span>
        </a>
      
    
  </section>


        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_tech/linux/Security Enhanced Linux.md"
          data-oid-likes="likes_tech/linux/Security Enhanced Linux.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      

      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
      
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2">
        <ul class="flex list-none flex-row">
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 me-4">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href=""
                title="">
                
                
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          
      </p>
    

    
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="https://davidwrites.xyz/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
